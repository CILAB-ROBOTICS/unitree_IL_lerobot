Resolving data files: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 159277.37it/s]
Resolving data files: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:00<00:00, 18082.79it/s]
  0%|                                                                                                                                 | 0/100 [15:09<?, ?it/s]
Traceback (most recent call last):
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 740, in <module>
    run_clip_pretraining(args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 703, in run_clip_pretraining
    clip_pretraining(train_dataset, test_dataset, train_features, save_dir=save_run_dir, args=args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 490, in clip_pretraining
    loss, plot_maps, batch_loss_dict = clip_loss(image_embeddings, tactile_embeddings, carpet_embeddings,
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 227, in clip_loss
    loss, _ = compute_pair_loss(image_embeddings[:, i], carpet_embeddings[:, k])
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 197, in compute_pair_loss
    loss = (F.cross_entropy(logits_12, targets) + F.cross_entropy(logits_21, targets)) / 2
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 3458, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
ValueError: Expected input batch_size (15) to match target batch_size (16).
Traceback (most recent call last):
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 740, in <module>
    run_clip_pretraining(args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 703, in run_clip_pretraining
    clip_pretraining(train_dataset, test_dataset, train_features, save_dir=save_run_dir, args=args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 490, in clip_pretraining
    loss, plot_maps, batch_loss_dict = clip_loss(image_embeddings, tactile_embeddings, carpet_embeddings,
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 227, in clip_loss
    loss, _ = compute_pair_loss(image_embeddings[:, i], carpet_embeddings[:, k])
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 197, in compute_pair_loss
    loss = (F.cross_entropy(logits_12, targets) + F.cross_entropy(logits_21, targets)) / 2
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 3458, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
ValueError: Expected input batch_size (15) to match target batch_size (16).
