Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 133193.96it/s]
Resolving data files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:00<00:00, 47675.76it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:00<00:00, 155057.45it/s]
  0%|                                                                                                                                                               | 0/100 [00:00<?, ?it/s]WARNING 2025-11-20 07:06:21 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 07:11:48 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 07:11:48 /pretrain.py:44 Requested top-10 but batch size is 1.
  1%|█▍                                                                                                                                                | 1/100 [20:52<34:27:06, 1252.80s/it]WARNING 2025-11-20 07:26:33 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 07:31:58 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 07:31:58 /pretrain.py:44 Requested top-10 but batch size is 1.
  2%|██▉                                                                                                                                               | 2/100 [41:03<33:25:19, 1227.75s/it]WARNING 2025-11-20 07:46:56 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 07:52:21 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 07:52:21 /pretrain.py:44 Requested top-10 but batch size is 1.
  3%|████▎                                                                                                                                           | 3/100 [1:01:25<33:00:56, 1225.32s/it]WARNING 2025-11-20 08:07:12 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 08:12:26 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 08:12:26 /pretrain.py:44 Requested top-10 but batch size is 1.
  4%|█████▊                                                                                                                                          | 4/100 [1:21:30<32:27:50, 1217.40s/it]WARNING 2025-11-20 08:26:48 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 08:31:54 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 08:31:54 /pretrain.py:44 Requested top-10 but batch size is 1.
  5%|███████▏                                                                                                                                        | 5/100 [1:40:58<31:39:30, 1199.69s/it]WARNING 2025-11-20 08:46:17 /pretrain.py:44 Requested top-10 but batch size is 8.
WARNING 2025-11-20 08:51:28 /pretrain.py:44 Requested top-5 but batch size is 1.
WARNING 2025-11-20 08:51:28 /pretrain.py:44 Requested top-10 but batch size is 1.
  6%|████████▋                                                                                                                                       | 6/100 [2:01:44<31:47:14, 1217.38s/it]
Traceback (most recent call last):
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 646, in <module>
    run_clip_pretraining(args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 609, in run_clip_pretraining
    clip_pretraining(train_dataset, test_dataset, train_features, save_dir=save_run_dir, args=args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 228, in clip_pretraining
    for batch_idx, batch in enumerate(train_loader):
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataset.py", line 346, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/lerobot_dataset.py", line 739, in __getitem__
    video_frames = self._query_videos(query_timestamps, ep_idx)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/lerobot_dataset.py", line 711, in _query_videos
    frames = decode_video_frames(video_path, query_ts, self.tolerance_s, self.video_backend)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/video_utils.py", line 66, in decode_video_frames
    return decode_video_frames_torchcodec(video_path, timestamps, tolerance_s)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/video_utils.py", line 206, in decode_video_frames_torchcodec
    frames_batch = decoder.get_frames_at(indices=frame_indices)
  File "/usr/local/lib/python3.10/dist-packages/torchcodec/decoders/_video_decoder.py", line 259, in get_frames_at
    data, pts_seconds, duration_seconds = core.get_frames_at_indices(
  File "/usr/local/lib/python3.10/dist-packages/torchcodec/_core/ops.py", line 246, in get_frames_at_indices
    return _get_frames_at_indices_tensor_input(decoder, frame_indices=frame_indices)
  File "/usr/local/lib/python3.10/dist-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
KeyboardInterrupt
Traceback (most recent call last):
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 646, in <module>
    run_clip_pretraining(args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 609, in run_clip_pretraining
    clip_pretraining(train_dataset, test_dataset, train_features, save_dir=save_run_dir, args=args)
  File "/workspace/cilab_unitree_lerobot/lerobot/lerobot/scripts/pretrain.py", line 228, in clip_pretraining
    for batch_idx, batch in enumerate(train_loader):
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataset.py", line 346, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/lerobot_dataset.py", line 739, in __getitem__
    video_frames = self._query_videos(query_timestamps, ep_idx)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/lerobot_dataset.py", line 711, in _query_videos
    frames = decode_video_frames(video_path, query_ts, self.tolerance_s, self.video_backend)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/video_utils.py", line 66, in decode_video_frames
    return decode_video_frames_torchcodec(video_path, timestamps, tolerance_s)
  File "/workspace/unitree_lerobot/lerobot/lerobot/common/datasets/video_utils.py", line 206, in decode_video_frames_torchcodec
    frames_batch = decoder.get_frames_at(indices=frame_indices)
  File "/usr/local/lib/python3.10/dist-packages/torchcodec/decoders/_video_decoder.py", line 259, in get_frames_at
    data, pts_seconds, duration_seconds = core.get_frames_at_indices(
  File "/usr/local/lib/python3.10/dist-packages/torchcodec/_core/ops.py", line 246, in get_frames_at_indices
    return _get_frames_at_indices_tensor_input(decoder, frame_indices=frame_indices)
  File "/usr/local/lib/python3.10/dist-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
KeyboardInterrupt
